<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sport Lokator Mobile</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@700&display=swap" rel="stylesheet">
    
    <style>
        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            overflow: hidden; /* Spreƒçava skrolovanje van mape */
            background-color: #1a1a1a;
        }

        /* Portrait Mode Optimizacija */
        #hero {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, rgba(0,0,0,0.4), rgba(0,0,0,0.8)), 
                        url('https://images.unsplash.com/photo-1540747913346-19e3adcc174b?q=80&w=1000&auto=format&fit=crop') center/cover;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            text-align: center;
            padding: 20px;
        }

        #hero h1 {
            color: #fff;
            font-family: 'Oswald', sans-serif;
            font-size: 2.5rem;
            margin-bottom: 30px;
            text-shadow: 2px 2px 10px rgba(0,0,0,0.5);
        }

        .sport-icon {
            width: 120px;
            height: 120px;
            background: rgba(255,255,255,0.1);
            border: 3px solid #fff;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-shadow: 0 0 20px rgba(255,255,255,0.2);
        }

        /* Mapa - preko celog ekrana */
        #map {
            width: 100vw;
            height: 100vh;
            display: none;
        }

        /* Mobilni Search - veƒái i pristupaƒçniji */
        .search-container {
            position: absolute;
            top: 15px;
            right: 15px;
            z-index: 3000;
            display: none;
            align-items: center;
            justify-content: flex-end;
            width: calc(100% - 30px);
        }

        #search-input {
            height: 50px;
            border-radius: 25px;
            border: none;
            padding: 0;
            width: 0;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 16px; /* Spreƒçava iOS auto-zoom na inputu */
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .search-container.active #search-input {
            width: 100%;
            padding: 0 55px 0 20px;
            opacity: 1;
        }

        .search-icon {
            width: 50px;
            height: 50px;
            background: #fff;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            font-size: 22px;
            position: absolute;
            right: 0;
        }

        /* Sakrivanje nepotrebnih Leaflet elemenata */
        .leaflet-control-attribution { font-size: 8px !important; }
    </style>
</head>
<body>

    <div id="hero" onclick="initApp()">
        <h1>LOKALNI<br>SPORTOVI</h1>
        <div class="sport-icon">
            <img src="https://cdn-icons-png.flaticon.com/512/857/857418.png" width="80" alt="Start">
        </div>
        <p style="color: #ddd; margin-top: 20px; font-weight: bold;">DODIRNI EKRAN ZA MAPU</p>
    </div>

    <div class="search-container" id="searchBox">
        <input type="text" id="search-input" placeholder="Pronaƒëi grad...">
        <div class="search-icon" onclick="toggleSearch()">üîç</div>
    </div>

    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        let map;

        function initApp() {
            document.getElementById('hero').style.display = 'none';
            document.getElementById('map').style.display = 'block';
            document.getElementById('searchBox').style.display = 'flex';
            setupMap();
        }

        function setupMap() {
            // Pode≈°avanja za mobilni: onemoguƒáen svaki vid zumiranja
            map = L.map('map', {
                zoomControl: false,
                scrollWheelZoom: false,
                doubleClickZoom: false,
                touchZoom: false,
                boxZoom: false,
                keyboard: false,
                dragging: true, // Dozvoljava pomeranje prstom
                tap: true      // Omoguƒáava tap na mobilnim ureƒëajima
            }).setView([44.0165, 21.0059], 12); 

            // ƒåist stil mape: granice, gradovi i ulice
            L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
                attribution: '&copy; OSM'
            }).addTo(map);

            // GPS lociranje
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(position => {
                    const lat = position.coords.latitude;
                    const lon = position.coords.longitude;
                    map.setView([lat, lon], 12);
                    L.circle([lat, lon], {
                        color: 'blue',
                        fillColor: '#30f',
                        fillOpacity: 0.2,
                        radius: 300
                    }).addTo(map);
                }, () => {
                    console.log("GPS pristup odbijen.");
                });
            }
        }

        function toggleSearch() {
            const container = document.getElementById('searchBox');
            const input = document.getElementById('search-input');
            
            if (!container.classList.contains('active')) {
                container.classList.add('active');
                input.focus();
            } else {
                if (input.value !== '') {
                    searchCity(input.value);
                }
                container.classList.remove('active');
            }
        }

        function searchCity(city) {
            fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${city}`)
                .then(res => res.json())
                .then(data => {
                    if (data.length > 0) {
                        // Samo pomera mapu na grad, ne menja nivo zuma (onemoguƒáeno)
                        map.panTo([data[0].lat, data[0].lon]);
                    }
                });
        }

        // Enter taster na tastaturi telefona
        document.getElementById('search-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') toggleSearch();
        });
    </script>
</body>
</html>
